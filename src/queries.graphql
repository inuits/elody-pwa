fragment minimalEntity on Entity {
  id
  type
  metadata(key: [title, object_number]) {
    key
    value
    lang
    immutable
  }
  primary_mediafile
}

fragment nestedEntity on Entity {
  id
  type
  metadataCollection {
    label
    nested
    key
    data {
      value
      unMappedKey
      label
    }
  }
}

fragment fullEntity on Entity {
  id
  type
  title: metadata(key: [title]) {
    key
    value
    lang
    immutable
  }
  mediafiles {
    _id
    original_file_location
    filename
    thumbnail_file_location
    metadata {
      key
      value
    }
  }
  metadataCollection {
    label
    nested
    key
    data {
      value
      unMappedKey
      label
      nestedMetaData {
        ...nestedEntity
      }
    }
  }
  parents {
    ...minimalEntity
  }
  components {
    ...minimalEntity
  }
}

fragment fullRelation on Relation {
  key
  type
  label
}

fragment job on Job {
  job_type
  job_type
  job_info
  status
  user
  asset_id
  mediafile_id
  parent_job_id
  end_time
  start_time
  amount_of_jobs
  completed_jobs
  _id
  _key
  _rev
}

fragment jobWithSubJobs on Job {
  ...job
  sub_jobs {
    ...job
  }
}

query getEntities($limit: Int, $skip: Int, $searchValue: SearchFilter!) {
  Entities(limit: $limit, skip: $skip, searchValue: $searchValue) {
    count
    limit
    results {
      ...minimalEntity
    }
  }
}

query getFullEntities(
  $limit: Int
  $skip: Int
  $searchValue: SearchFilter!
  $fetchPolicy: String
) {
  Entities(
    limit: $limit
    skip: $skip
    searchValue: $searchValue
    fetchPolicy: $fetchPolicy
  ) {
    count
    limit
    results {
      ...fullEntity
    }
  }
}

query getEntityById($id: String!) {
  Entity(id: $id) {
    ...fullEntity
  }
}

query getDirectories($dir: String) {
  Directories(dir: $dir) {
    id
    dir
    has_subdirs
    parent
  }
}

query getEnumsByName($enumName: String!) {
  __type(name: $enumName) {
    name
    enumValues {
      name
    }
  }
}

query getJobs($paginationInfo: PaginationInfo, $filters: Filters) {
  Jobs(paginationInfo: $paginationInfo, filters: $filters) {
    results {
      ...job
    }
    count
    limit
    next
  }
}

query getJob($id: String!) {
  Job(id: $id) {
    ...jobWithSubJobs
  }
}

query getAdvancedFilters(){
  advancedFilter{
    label
    type
    key
  }
}

# query advancedQuery

mutation postStartImport($folder: String!) {
  StartImport(folder: $folder) {
    message_id
  }
}

mutation editMetadata($id: String!, $metadata: [MetadataInput!]!) {
  replaceMetadata(id: $id, metadata: $metadata) {
    key
    value
    lang
  }
}

mutation addComponent($id: String!, $relations: [RelationInput!]!) {
  addRelations(id: $id, relations: $relations) {
    key
    type
  }
}
